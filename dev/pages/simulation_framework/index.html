<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Simulation Framework · [∂F]</title><meta name="title" content="Simulation Framework · [∂F]"/><meta property="og:title" content="Simulation Framework · [∂F]"/><meta property="twitter:title" content="Simulation Framework · [∂F]"/><meta name="description" content="Documentation for [∂F]."/><meta property="og:description" content="Documentation for [∂F]."/><meta property="twitter:description" content="Documentation for [∂F]."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">[∂F]</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">DiffFusion.jl [∂F]</a></li><li><a class="tocitem" href="../overview/">Overview</a></li><li class="is-active"><a class="tocitem" href>Simulation Framework</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Hybrid-Model-Specification"><span>Hybrid Model Specification</span></a></li><li><a class="tocitem" href="#Hybrid-Model-Simulation"><span>Hybrid Model Simulation</span></a></li><li class="toplevel"><a class="tocitem" href="#Component-Models"><span>Component Models</span></a></li><li><a class="tocitem" href="#Interest-Rate-Models"><span>Interest Rate Models</span></a></li><li><a class="tocitem" href="#Tradeable-Asset-Models"><span>Tradeable Asset Models</span></a></li><li><a class="tocitem" href="#Future-Index/Price-Models"><span>Future Index/Price Models</span></a></li></ul></li><li><a class="tocitem" href="../../termstructures/termstructures/">Term Structures Functions</a></li><li><a class="tocitem" href="../../models/models/">Models Functions</a></li><li><a class="tocitem" href="../../models/rates_models/">Additional Rates Model Functions</a></li><li><a class="tocitem" href="../../simulations/simulations/">Simulations Functions</a></li><li><a class="tocitem" href="../../paths/paths/">Monte Carlo Paths Functions</a></li><li><a class="tocitem" href="../../payoffs/payoffs/">Payoffs Functions</a></li><li><a class="tocitem" href="../../products/products/">Products Functions</a></li><li><a class="tocitem" href="../../analytics/analytics/">Analytics Functions</a></li><li><a class="tocitem" href="../../examples/examples/">Examples (Module) Functions</a></li><li><a class="tocitem" href="../../serialisation/serialisation/">Serialisation Functions</a></li><li><a class="tocitem" href="../../utils/utils/">Utilities Functions</a></li><li><a class="tocitem" href="../additional_functions/">Additional Functions</a></li><li><a class="tocitem" href="../function_index/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Simulation Framework</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Simulation Framework</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/frame-consulting/DiffFusion.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/frame-consulting/DiffFusion.jl/blob/main/docs/src/pages/simulation_framework.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Simulation-Framework"><a class="docs-heading-anchor" href="#Simulation-Framework">Simulation Framework</a><a id="Simulation-Framework-1"></a><a class="docs-heading-anchor-permalink" href="#Simulation-Framework" title="Permalink"></a></h1><p>In this documentation we discuss our framework for efficient implementation of Monte Carlo methods that aim at simulating joint diffusion processes. The framework is designed with the following objectives in mind:</p><ul><li><p>Simulation should be exact (i.e. bias-free) if the underlying model   allows for exact simulation.</p></li><li><p>Framework should allow for efficient factorisation of the joint   covariance matrix and exploit independence structures.</p></li><li><p>Simulation should be formulated in terms of matrix and tensor   operations.</p></li></ul><p>Simulation models in scope are models for interest rates, FX rates, equities, inflation, futures and credit. Basic variants of such models can be formulated as Ornstein-Uhlenbeck (OU) processes. Such OU processes do allow for exact simulation.</p><p><strong>Common notation.</strong></p><ul><li><p><span>$X_{t}$</span> is an <span>$n$</span>-dimensional state variable which describes the   model dynamic.</p></li><li><p><span>$W_{u}$</span> is an <span>$m$</span>-dimensional Brownian motion under the common   risk-neutral measure <span>$\mathbb{Q}$</span>.</p></li><li><p><span>$\Gamma$</span> is an <span>$m\times m$</span> matrix representing correlations of   increments in <span>$W_{u}$</span>.</p></li><li><p><span>$s$</span>, <span>$u$</span>, <span>$t$</span> are simulation times with <span>$0\leq s\leq u\leq t$</span>.</p></li><li><p><span>$X_{t}^{k}$</span> for <span>$k=1,\ldots,N$</span> are model component states that   represent a slice of the full vector <span>$X_{t}$</span>.</p></li><li><p><span>$\Theta\left(\cdot\right)$</span>, <span>$H\left(\cdot\right)$</span>,   <span>$\Sigma\left(\cdot\right)$</span> and <span>$L\left(\cdot\right)$</span> are composite   model functions for the full state <span>$X_{t}$</span>.</p></li><li><p><span>$\Theta^{k}\left(\cdot\right)$</span>, <span>$H^{k}\left(\cdot\right)$</span> and   <span>$\Sigma^{k}\left(\cdot\right)$</span> are component model functions that   represent slices of <span>$\Theta\left(\cdot\right)$</span>,   <span>$H\left(\cdot\right)$</span> and <span>$\Sigma\left(\cdot\right)$</span>.</p></li><li><p><span>$V\left(s,t,X_{s}\right)$</span> is a diagonal <span>$n\times n$</span> matrix   representing volatilities of the increments of state vector <span>$X_{t}$</span>.</p></li><li><p><span>$C\left(s,t,X_{s}\right)$</span> is a <span>$n\times n$</span> matrix representing   correlations of the increments of state vector <span>$X_{t}$</span>.</p></li><li><p><span>$Z^{\left(1\right)},\ldots,Z^{\left(p\right)}$</span> are independent   <span>$n$</span>-dimensional standard normal random variables for <span>$p$</span> paths.</p></li><li><p><span>$X_{t}^{\left(1\right)},\ldots,X_{t}^{\left(p\right)}$</span> are simulated   realisations of the full random state variable <span>$X_{t}$</span> for <span>$p$</span>   paths.</p></li></ul><h1 id="Hybrid-Model-Specification"><a class="docs-heading-anchor" href="#Hybrid-Model-Specification">Hybrid Model Specification</a><a id="Hybrid-Model-Specification-1"></a><a class="docs-heading-anchor-permalink" href="#Hybrid-Model-Specification" title="Permalink"></a></h1><p>The hybrid model is described by a multi-variate process <span>$\left(X_{t}\right)_{t}$</span> with <span>$X_{t}\in\mathbb{R}^{n}$</span> and initial condition <span>$X_{0}=0$</span>. The elements of the process <span>$\left(X_{t}\right)_{t}$</span> are grouped into <em>models</em>. That is, we decompose</p><p class="math-container">\[X_{t}=\left[\begin{array}{c}
X_{t}^{1}\\
\vdots\\
X_{t}^{N}
\end{array}\right].\]</p><p>Each component model is descibed by the process <span>$\left(X_{t}^{k}\right)_{t}$</span> with <span>$X_{t}^{k}\in\mathbb{R}^{n_{k}}$</span>, <span>$k=1,\ldots,N$</span>. Each component model is specified independently but with a common interface. This allows for a flexible combination of models.</p><p><strong>Component models.</strong></p><p>Denote <span>$\left(\Omega,{\cal F}_{t},\mathbb{Q}\right)$</span> a filtered probability space with (risk-neutral) probability measure <span>$\mathbb{Q}$</span>. The common structure of the component models is given by the dynamics</p><p class="math-container">\[X_{t}^{k}=\Theta^{k}\left(s,t,X_{s}\right)+H^{k}\left(s,t,X_{s}\right)X_{s}+\int_{s}^{t}\Sigma^{k}\left(u,X_{s}\right)^{\top}dW_{u}\]</p><p>for <span>$0\leq s\leq t$</span>. Here, <span>$\Theta^{k}\left(s,t,X_{s}\right)\in\mathbb{R}^{n_{k}}$</span> is a deterministic drift vector. The matrix <span>$H^{k}\left(s,t,X_{s}\right)\in\mathbb{R}^{n_{k}\times n}$</span> typically accounts for mean reversion in the component model. Finally, the matrix <span>$\Sigma^{k}\left(u,X_{s}\right)^{\top}\in\mathbb{R}^{n_{k}\times m}$</span> represents the volatility function of the component model and <span>$W_{u}\in\mathbb{R}^{m}$</span> is an <span>$m$</span>-dimensional vector of Brownian motions under <span>$\mathbb{Q}$</span>.</p><p>Above specification is fairly general. We make a few comments to indicate how concrete component models will implement the specification.</p><ol><li><p>The component model functions <span>$\Theta^{k}$</span>, <span>$H^{k}$</span> and <span>$\Sigma^{k}$</span>  may depend on the model state <span>$X_{s}$</span>. However, we impose that the  model state is observed at time <span>$s$</span>. This allows to cover local and  stochastic volatility models. But the component model functions  already need to implement some time-discretisation.</p></li><li><p>Ideally, the component model functions <span>$\Theta^{k}$</span>, <span>$H^{k}$</span> and  <span>$\Sigma^{k}$</span> are independent of the model state. This is the case  for models based on OU processes. Then simulation can be exact.</p></li><li><p>In typical cases, component model states <span>$X_{t}^{k}$</span> do not depend  on the full hybrid model state <span>$X_{s}$</span>. Instead, <span>$X_{t}^{k}$</span> (as  well as <span>$\Theta^{k}$</span>, <span>$H^{k}$</span> and <span>$\Sigma^{k}$</span>) only use information  from <span>$X_{s}^{k}$</span> plus a few dependencies to other models.  Consequently, the dimensions <span>$n$</span> and <span>$m$</span> can effectively be reduced  to numbers in the order of <span>$n_{k}$</span>. We leave the general  representation in order to keep notation brief. But keep in mind  that with the general notation the full matrices <span>$H^{k}$</span> and  <span>$\Sigma^{k}$</span> will be sparse.</p></li></ol><h2 id="Hybrid-Model-Simulation"><a class="docs-heading-anchor" href="#Hybrid-Model-Simulation">Hybrid Model Simulation</a><a id="Hybrid-Model-Simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Hybrid-Model-Simulation" title="Permalink"></a></h2><p>Our general component model specification yields that the hybrid model dynamics become</p><p class="math-container">\[X_{t}=\Theta\left(s,t,X_{s}\right)+H\left(s,t,X_{s}\right)X_{s}+\int_{s}^{t}\Sigma\left(u,X_{s}\right)^{\top}dW_{u}\]</p><p>with composite hybrid model functions</p><p class="math-container">\[\begin{aligned}
\Theta\left(s,t,X_{s}\right) &amp; =\left[\begin{array}{c}
\Theta^{1}\left(s,t,X_{s}\right)\\
\vdots\\
\Theta^{N}\left(s,t,X_{s}\right)
\end{array}\right]\in\mathbb{R}^{n},\\
H\left(s,t,X_{s}\right) &amp; =\left[\begin{array}{c}
H^{1}\left(s,t,X_{s}\right)^{\top}\\
\vdots\\
H^{N}\left(s,t,X_{s}\right)^{\top}
\end{array}\right]\in\mathbb{R}^{n\times n},\quad\text{and}\\
\Sigma\left(u,X_{s}\right)^{\top} &amp; =\left[\begin{array}{c}
\Sigma^{1}\left(u,X_{s}\right)^{\top}\\
\vdots\\
\Sigma^{N}\left(u,X_{s}\right)^{\top}
\end{array}\right]\in\mathbb{R}^{n\times m}.
\end{aligned}\]</p><p>As a consequence, we find that <span>$X_{t}|X_{s}$</span> is multi-variate normally distributed with</p><p class="math-container">\[\mathbb{E}\left[X_{t}|X_{s}\right]=\Theta\left(s,t,X_{s}\right)+H\left(s,t,X_{s}\right)X_{s}\in\mathbb{R}^{n}\]</p><p>and</p><p class="math-container">\[\text{Cov}\left[X_{t}|X_{s}\right]=\int_{s}^{t}\Sigma\left(u,X_{s}\right)^{\top}\,\Gamma\,\Sigma\left(u,X_{s}\right)dt\in\mathbb{R}^{n\times n}.\]</p><p>The constant symmetric matrix <span>$\Gamma\in\mathbb{R}^{m\times m}$</span> represents the instantaneous correlations of increments <span>$dW_{t}$</span>. We get for the elements <span>$\text{Cov}\left[X_{t}|X_{s}\right]_{i,j}$</span> of the covariance matrix</p><p class="math-container">\[\begin{aligned}
\text{Cov}\left[X_{t}|X_{s}\right]_{i,j} &amp; =\int_{s}^{t}\Sigma\left(u,X_{s}\right)_{i}^{\top}\,\Gamma\,\Sigma\left(u,X_{s}\right)_{j}du.
\end{aligned}\]</p><p>Here, <span>$\Sigma\left(u,X_{s}\right)_{i}$</span> and <span>$\Sigma\left(u,X_{s}\right)_{j}$</span> are the <span>$i$</span>-th and <span>$j$</span>-th column (<span>$i,j=1,\ldots,n$</span>) of the volatility matrix <span>$\Sigma\left(u,X_{s}\right)$</span>.</p><p>The covariance matrix is decomposed into a diagonal state-volatility matrix <span>$V\left(s,t,X_{s}\right)$</span> and a state-correlation matrix <span>$C\left(s,t,X_{s}\right)$</span> such that</p><p class="math-container">\[\begin{aligned}
\left[V\left(s,t,X_{s}\right)\right]_{i.i} &amp; =\sqrt{\left[\text{Cov}\left[X_{t}|X_{s}\right]\right]_{i,i}/\left(t-s\right)},\\
\left[C\left(s,t,X_{s}\right)\right]_{i.i} &amp; =1,\\
\left[C\left(s,t,X_{s}\right)\right]_{i.j} &amp; =\begin{cases}
\frac{\left[\text{Cov}\left[X_{t}|X_{s}\right]\right]_{i,j}}{\left[V\left(s,t,X_{s}\right)\right]_{i.i}\left[V\left(s,t,X_{s}\right)\right]_{j.j}\left(t-s\right)} &amp; \text{if }\left[V\left(s,t,X_{s}\right)\right]_{i.i}\left[V\left(s,t,X_{s}\right)\right]_{j.j}&gt;0\\
0 &amp; \text{else}
\end{cases}
\end{aligned}\]</p><p>for all indices <span>$i,j=1,\ldots,n$</span>. Then <span>$\text{Cov}\left[X_{t}|X_{s}\right]=V\left(s,t,X_{s}\right)C\left(s,t,X_{s}\right)V\left(s,t,X_{s}\right)\left(t-s\right).$</span></p><p>If all model functions are independent of the state <span>$X_{s}$</span> then we can directly calculate a (Cholesky) decomposition</p><p class="math-container">\[\text{Cov}\left[X_{t}|X_{s}\right]=V\left(s,t\right)\,L\left(s,t\right)\,L\left(s,t\right)^{\top}\,V\left(s,t\right)\,\left(t-s\right).\]</p><p>With such a factorisation we can simulate</p><p class="math-container">\[X_{t}=\Theta\left(s,t\right)+H\left(s,t\right)X_{s}+V\left(s,t\right)\,L\left(s,t\right)\,Z\,\sqrt{t-s}\]</p><p>with standard normal vectors <span>$Z\sim{\cal N}\left(0,1\right)$</span>. For a list of paths <span>$\left[X_{s}^{\left(1\right)},\ldots,X_{s}^{\left(p\right)}\right]\in\mathbb{R}^{n\times p}$</span> and standard normal increments <span>$\left[Z^{\left(1\right)},\ldots,Z^{\left(p\right)}\right]\in\mathbb{R}^{n\times p}$</span> this can be implemented as matrix multiplication and addition</p><p class="math-container">\[\begin{aligned}
\left[X_{t}^{\left(1\right)},\ldots,X_{t}^{\left(p\right)}\right] &amp; =\left[\Theta\left(s,t\right),\ldots,\Theta\left(s,t\right)\right]\\
 &amp; \quad+H\left(s,t\right)^{\top}\left[X_{s}^{\left(1\right)},\ldots,X_{s}^{\left(p\right)}\right]\\
 &amp; \quad+V\left(s,t\right)\,L\left(s,t\right)\,\left[Z^{\left(1\right)},\ldots,Z^{\left(p\right)}\right]\,\sqrt{t-s}.
\end{aligned}\]</p><p>The assumption of state-independent model component functions holds e.g. for Gaussian short rate models, Black-Scholes equity/foreign exchange models, and Dodgson-Kainth inflation model.</p><h1 id="Component-Models"><a class="docs-heading-anchor" href="#Component-Models">Component Models</a><a id="Component-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Component-Models" title="Permalink"></a></h1><p>In this section, we specify component models for our hybrid model framework.</p><h2 id="Interest-Rate-Models"><a class="docs-heading-anchor" href="#Interest-Rate-Models">Interest Rate Models</a><a id="Interest-Rate-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Interest-Rate-Models" title="Permalink"></a></h2><p>Interest rate models are formulated as separable Heath-Jarrow-Morton (HJM) models for the continuous forward rate <span>$f\left(t,T\right)$</span> with observation time <span>$t$</span> and term <span>$T$</span>.</p><p>Our specification follows in large parts <a href="../overview/#label_literature_and_references">Andersen/Piterbarg, <em>Interest Rate Modeling</em>, 2010</a>, Sec. 4.4 and 4.5.</p><p>Forward rates are directly linked to zero coupon bonds <span>$P\left(t,T\right)$</span>. We have</p><p class="math-container">\[P\left(t,T\right)=\exp\left\{ -\int_{t}^{T}f\left(t,s\right)ds\right\}\]</p><p>or equivalently</p><p class="math-container">\[f\left(t,T\right)=-\frac{\partial}{\partial T}\log\left(P\left(t,T\right)\right).\]</p><p>We formulate the model in risk neutral measure. The risk neutral measure uses the continuous bank account as numeraire. The bank account accruals at the short rate</p><p class="math-container">\[r_{t}=f(t,t).\]</p><p>And the price process of the bank account <span>$\left(B_{t}\right)_{t}$</span> is given by</p><p class="math-container">\[B_{t}=e^{\int_{0}^{t}r_{s}ds}.\]</p><h3 id="Heath-Jarrow-Morton-Modelling-Framework"><a class="docs-heading-anchor" href="#Heath-Jarrow-Morton-Modelling-Framework">Heath-Jarrow-Morton Modelling Framework</a><a id="Heath-Jarrow-Morton-Modelling-Framework-1"></a><a class="docs-heading-anchor-permalink" href="#Heath-Jarrow-Morton-Modelling-Framework" title="Permalink"></a></h3><p>Consider a general HJM model for the forward rates <span>$f(t,T)$</span>. No-arbitrage considerations yield the dynamics</p><p class="math-container">\[df\left(t,T\right)=\sigma_{f}\left(t,T\right)^{\top}\cdot\left[\int_{t}^{T}\sigma_{f}\left(t,u\right)du\right]\cdot dt+\sigma_{f}\left(t,T\right)^{\top}\cdot dW_{t}.\]</p><p>Here, <span>$\sigma_{f}\left(t,T\right)^{\top}$</span> is a <span>$d$</span>-dimensional vector of forward rate volatilities and <span>$W_{t}$</span> is a <span>$d$</span>-dimensional Brownian motion in the risk-neutral measure. The drift term of the HJM model follows from no-arbitrage considerations. Thus it remains to specify the forward rate volatility function <span>$\sigma_{f}\left(t,T\right)^{\top}$</span>.</p><p>In an HJM model with separable volatility the forward rate volatility takes the form <span>$\sigma_{f}\left(t,T\right)=g\left(t\right)h\left(T\right)$</span>. Here <span>$g\left(t\right)=g\left(t,\omega\right)\in\mathbb{R}^{d\times d}$</span> is a matrix-valued process adapted to <span>${\cal F}_{t}$</span> and <span>$h\left(T\right)\in\mathbb{R}^{d}$</span> is a vector-valued deterministic function. The models of this class are also considered Quasi-Gaussian models.</p><p>For an HJM model we get the bond price dynamics in risk-neutral measure as</p><p class="math-container">\[\frac{dP\left(t,T\right)}{P\left(t,T\right)}=r_{t}\cdot dt-\sigma_{P}\left(t,T\right)^{\top}\cdot dW_{t}.\]</p><p>The minus sign indicates that if rates increase bond prices decrease (and vice versa). In a separable volatility HJM model the bond price volatility becomes</p><p class="math-container">\[\sigma_{P}\left(t,T\right)=g\left(t\right)\cdot\int_{t}^{T}h\left(u\right)\cdot du.\]</p><p>Integration yields the forward rates</p><p class="math-container">\[\begin{aligned}
f\left(t,T\right) &amp; =f\left(0,T\right)+\\
 &amp; \quad h\left(T\right)^{\top}\int_{0}^{t}g\left(s\right)^{\top}g\left(s\right)\left(\int_{s}^{T}h\left(u\right)du\right)ds+\\
 &amp; \quad h\left(T\right)^{\top}\int_{0}^{t}g\left(s\right)^{\top}dW_{s}
\end{aligned}\]</p><p>and</p><p class="math-container">\[r_{t}=f\left(0,t\right)+h\left(t\right)^{\top}\left[\int_{0}^{t}g\left(s\right)^{\top}g\left(s\right)\left(\int_{s}^{t}h\left(u\right)du\right)ds+\int_{0}^{t}g\left(s\right)^{\top}dW_{s}\right].\]</p><p>We can re-write <span>$h\left(t\right)^{\top}=\boldsymbol{1}^{\top}H\left(t\right)$</span> and get</p><p class="math-container">\[r(t)=f(0,t)+\boldsymbol{1}^{\top}H\left(t\right)\left[\int_{0}^{t}g\left(s\right)^{\top}g\left(s\right)\left(\int_{s}^{t}h\left(u\right)du\right)ds+\int_{0}^{t}g\left(s\right)^{\top}dW_{s}\right]\]</p><p>with</p><p class="math-container">\[\boldsymbol{1}=\left(\begin{array}{c}
1\\
\vdots\\
1
\end{array}\right)\text{ and }H\left(t\right)=\text{diag}\left(h\left(t\right)\right)=\left(\begin{array}{ccc}
h_{1}\left(t\right) &amp; 0 &amp; 0\\
0 &amp; \ddots &amp; 0\\
0 &amp; 0 &amp; h_{d}\left(t\right)
\end{array}\right).\]</p><p>Now, we can introduce the vector of state variables <span>$x_{t}$</span> with</p><p class="math-container">\[\begin{aligned}
x_{t} &amp; =H\left(t\right)\left[\int_{0}^{t}g\left(s\right)^{\top}g\left(s\right)\left(\int_{s}^{t}h\left(u\right)du\right)ds+\int_{0}^{t}g\left(s\right)^{\top}dW_{s}\right]\\
 &amp; =H\left(t\right)\left[\int_{0}^{t}g\left(s\right)^{\top}\sigma_{P}\left(s,t\right)ds+\int_{0}^{t}g\left(s\right)^{\top}dW_{s}\right]
\end{aligned}\]</p><p>Some (lengthy) calculations yield the representation</p><p class="math-container">\[H\left(t\right)^{-1}x_{t}-H\left(s\right)^{-1}x_{s}=H\left(s\right)^{-1}y_{s}G\left(s,t\right)+\int_{s}^{t}g\left(u\right)^{\top}\left[\sigma_{P}\left(u,t\right)du+dW_{u}\right]\]</p><p>with model function</p><p class="math-container">\[G\left(s,t\right)=\int_{s}^{t}H\left(s\right)^{-1}H\left(u\right)\boldsymbol{1}du\]</p><p>and auxilliary state variable process</p><p class="math-container">\[y_{t}=H\left(t\right)\left(\int_{0}^{t}g\left(s\right)^{\top}g\left(s\right)ds\right)H\left(t\right).\]</p><p><strong>Separation of volatility and mean reversion.</strong></p><p>In order to better separate volatility and mean reversion components, we set</p><p class="math-container">\[\begin{aligned}
g\left(t\right) &amp; =H\left(t\right)^{-1}\sigma_{t},\\
H\left(s,t\right) &amp; =H\left(t\right)H\left(s\right)^{-1}.
\end{aligned}\]</p><p>Then</p><p class="math-container">\[\begin{aligned}
x_{t} &amp; =H\left(s,t\right)\left[x_{s}+y_{s}G\left(s,t\right)+\int_{s}^{t}H\left(s,u\right)^{-1}\sigma_{u}^{\top}\left[\sigma_{u}G\left(u,t\right)du+dW_{u}\right]\right],\\
y_{t} &amp; =H\left(s,t\right)y_{s}H\left(s,t\right)+\int_{s}^{t}H\left(u,t\right)\sigma_{u}^{\top}\sigma_{u}H\left(u,t\right)ds,\\
G\left(s,t\right) &amp; =\int_{s}^{t}H\left(s,u\right)\boldsymbol{1}du,\\
\sigma_{P}\left(u,t\right) &amp; =\sigma_{u}G\left(u,t\right).
\end{aligned}\]</p><p>Above representation is the basis for our hybrid model interface.</p><p>We note, that we also get the following equality for the drift terms</p><p class="math-container">\[\underbrace{y_{s}G\left(s,t\right)+\int_{s}^{t}H\left(s,u\right)^{-1}\sigma_{u}^{\top}\sigma_{u}G\left(u,t\right)du}_{I_{1}\left(t\right)}=\underbrace{\int_{s}^{t}H\left(s,u\right)^{-1}y_{u}\boldsymbol{1}du}_{I_{2}\left(t\right)}.\]</p><p>This property follows by differentiating both sides w.r.t. <span>$t$</span>. Then we get for the left side of the equation</p><p class="math-container">\[\begin{aligned}
I_{1}&#39;\left(t\right) &amp; =y_{s}H\left(s,t\right)\boldsymbol{1}+\int_{s}^{t}H\left(s,u\right)^{-1}\sigma_{u}^{\top}\sigma_{u}H\left(u,t\right)\boldsymbol{1}du\\
 &amp; =y_{s}H\left(s,t\right)\boldsymbol{1}+H\left(s,t\right)^{-1}\int_{s}^{t}H\left(u,t\right)\sigma_{u}^{\top}\sigma_{u}H\left(u,t\right)\boldsymbol{1}du\\
 &amp; =y_{s}H\left(s,t\right)\boldsymbol{1}+H\left(s,t\right)^{-1}\left[y_{t}-H\left(s,t\right)y_{s}H\left(s,t\right)\right]\boldsymbol{1}\\
 &amp; =H\left(s,t\right)^{-1}y_{t}\boldsymbol{1}\\
 &amp; =I_{2}&#39;\left(t\right).
\end{aligned}\]</p><p>The alternative representation of the drift term is useful in some situations because the integrand does not depend on the upper boundary <span>$t$</span>. We get</p><p class="math-container">\[x_{t}=H\left(s,t\right)\left[x_{s}+\int_{s}^{t}H\left(s,u\right)^{-1}\left[y_{u}\boldsymbol{1}du+\sigma_{u}^{\top}dW_{u}\right]\right].\]</p><p><strong>Integrated state variable.</strong></p><p>In addition to the state variable <span>$x_{t}$</span> itself we are also interested in the integrated state variable <span>$z_{t}=\boldsymbol{1}^{\top}\int_{0}^{t}x_{s}ds$</span>. In order to derive the dynamics of the integrated state variable, we need to calculate</p><p class="math-container">\[\begin{aligned}
I\left(s,t\right) &amp; =\int_{s}^{t}x_{v}dv\\
 &amp; =\int_{s}^{t}\left(H\left(s,v\right)\left[x_{s}+\int_{s}^{v}H\left(s,u\right)^{-1}\left[y_{u}\boldsymbol{1}du+\sigma_{u}^{\top}dW_{u}\right]\right]\right)dv.
\end{aligned}\]</p><p>For the first term, we get</p><p class="math-container">\[\int_{s}^{t}H\left(s,v\right)x_{s}dv=\text{diag}\left(G\left(s,t\right)\right)x_{s}.\]</p><p>In order to simplify calculation for the second term we substitute <span>$d\bar{W}_{u}=y_{u}\boldsymbol{1}du+\sigma_{u}^{\top}dW_{u}$</span>. Then</p><p class="math-container">\[\begin{aligned}
\int_{s}^{t}H\left(s,v\right)\int_{s}^{v}H\left(s,u\right)^{-1}d\bar{W}_{u}dv &amp; =\int_{s}^{t}\int_{s}^{v}H\left(u,v\right)d\bar{W}_{u}dv\\
 &amp; =\int_{s}^{t}\left(\int_{u}^{t}H\left(u,v\right)dv\right)d\bar{W}_{u}\\
 &amp; =\int_{s}^{t}\text{diag}\left(G\left(u,t\right)\right)d\bar{W}_{u}.
\end{aligned}\]</p><p>This yields</p><p class="math-container">\[I\left(s,t\right)=\text{diag}\left(G\left(s,t\right)\right)x_{s}+\int_{s}^{t}\text{diag}\left(G\left(u,t\right)\right)\left[y_{u}\boldsymbol{1}du+\sigma_{u}^{\top}dW_{u}\right].\]</p><p>With these preparations we get <span>$z_{t}=z_{s}+G\left(s,t\right)^{\top}x_{s}+\int_{s}^{t}G\left(u,t\right)^{\top}\left[y_{u}\boldsymbol{1}du+\sigma_{u}^{\top}dW_{u}\right].$</span></p><p><strong>Yield Curve Reconstruction</strong></p><p>We can derive future zero coupon bonds in terms of <span>$x_{t}$</span> and <span>$y_{t}$</span> as</p><p class="math-container">\[P(t,T)=\frac{P(0,T)}{P(0,t)}\exp\left\{ -G(t,T)^{\top}x_{t}-\frac{1}{2}G(t,T)^{\top}y_{t}G(t,T)\right\}\]</p><p>and future forward rates as</p><p class="math-container">\[f(t,T)=f(0,T)+\boldsymbol{1}^{\top}H(T)H(t)^{-1}\left[x_{t}+y_{t}G(t,T)\right].\]</p><p>Also, we directly get the short rate representation</p><p class="math-container">\[r_{t}=f(0,t)+\boldsymbol{1}^{\top}x_{t}.\]</p><p>From the short rate we can also recontruct the bank account price process <span>$\left(B_{t}\right)_{t}$</span> as</p><p class="math-container">\[B_{t}=e^{\int_{0}^{t}r_{s}ds}=\frac{e^{z_{t}}}{P\left(0,t\right)}.\]</p><p>The zero coupon bond formula is the basic building block for calculating future option payoffs. More details on HJM models are elaborated in Andersen/Piterbarg, <em>Interest Rate Modeling</em>, 2010, Sec. 4.4 and 4.5. The bank account representation is used for numeraire calculation as well as future asset price reconstruction.</p><p><strong>Constant mean reversion specification.</strong></p><p>So far, we have not specified the structure of the matrix function <span>$H\left(t\right)$</span> in our separable HJM model. In order, to make the model tractable, we set</p><p class="math-container">\[H\left(t\right)=\text{diag}\left(\left[e^{-\chi_{1}t},\ldots,e^{-\chi_{d}t}\right]\right).\]</p><p>The parameters <span>$\chi_{1},\ldots,\chi_{d}$</span> represent the constant mean reversion parameters in the model.</p><p>With constant mean reversion parameters we can calculate</p><p class="math-container">\[H\left(s,t\right)=\text{diag}\left(\left[e^{-\chi_{1}\left(t-s\right)},\ldots,e^{-\chi_{d}\left(t-s\right)}\right]\right)\]</p><p>and</p><p class="math-container">\[G\left(s,t\right)=\left[\frac{1-e^{-\chi_{1}\left(t-s\right)}}{\chi_{1}},\ldots,\frac{1-e^{-\chi_{d}\left(t-s\right)}}{\chi_{d}}\right]^{\top}.\]</p><p><strong>Benchmark rates.</strong></p><p>We choose <span>$d$</span> benchmark rates <span>$f_{i}(t)=f(t,t+\delta_{i})$</span> (<span>$i=1,\ldots,d$</span>). The maturity terms <span>$\delta_{i}$</span> represent the points on the yield curve that are selected to be modelled specifically. Consequently, <span>$\delta_{1}$</span> to <span>$\delta_{d}$</span> should reasonably span the whole yield curve maturities relevant for pricing.</p><p>Furthermore, we denote</p><p class="math-container">\[H^{f}(t)=\left(\begin{array}{c}
h\left(t+\delta_{1}\right)^{\top}\\
\vdots\\
h\left(t+\delta_{d}\right)^{\top}
\end{array}\right)=\left(\begin{array}{ccc}
e^{-\chi_{1}\left(t+\delta_{1}\right)} &amp; \ldots &amp; e^{-\chi_{d}\left(t+\delta_{1}\right)}\\
\vdots &amp;  &amp; \vdots\\
e^{-\chi_{1}\left(t+\delta_{d}\right)} &amp; \ldots &amp; e^{-\chi_{d}\left(t+\delta_{d}\right)}
\end{array}\right)\]</p><p>which yields</p><p class="math-container">\[H(t)H^{f}(t)^{-1}=\left[H^{f}(t)H(t)^{-1}\right]^{-1}=\left(\begin{array}{ccc}
e^{-\chi_{1}\delta_{1}} &amp; \ldots &amp; e^{-\chi_{d}\delta_{1}}\\
\vdots &amp;  &amp; \vdots\\
e^{-\chi_{1}\delta_{d}} &amp; \ldots &amp; e^{-\chi_{d}\delta_{d}}
\end{array}\right)^{-1}.\]</p><p>Note that <span>$H(t)H^{f}(t)^{-1}$</span> is independent of the observation time <span>$t$</span>. Consequently, the matrix inversion only needs to be evaluated once at inception of the model.</p><p><strong>Benchmark rate volatility.</strong></p><p>Model volatility is characterised by the volatility specification of the benchmark rates as</p><p class="math-container">\[\sigma_{t}^{f}=\left(\begin{array}{ccc}
\sigma_{t}^{f_{1}}\\
 &amp; \ddots\\
 &amp;  &amp; \sigma_{t}^{f_{d}}
\end{array}\right).\]</p><p>The benchmark rate dynamics are coupled by a <span>$d\times d$</span> correlation matrix <span>$\Gamma_{f}$</span> which is decomposed into</p><p class="math-container">\[\Gamma_{f}=\left[D^{f}\right]^{\top}D^{f}.\]</p><p>For our specification we choose a time-homogenous correlation matrix. Hence, the matrix decomposition above only needs to be computed at inception of the model.</p><p>Given the above specifications the volatility of the HJM model is defined via</p><p class="math-container">\[\sigma_{t}^{\top}=H(t)H^{f}(t)^{-1}\sigma_{t}^{f}D^{f}(t)^{\top}.\]</p><p>The volatility specification is chosen such that dynamics of the benchmark rates become</p><p class="math-container">\[df_{i}(t)=O(dt)+\sigma_{t}^{f_{1}}dU_{i}(t)\]</p><p>with <span>$dU(t)=D^{f}(t)^{\top}dW(t)$</span>. For details on the derivation of the benchmark rate dynamics see Andersen/Piterbarg, <em>Interest Rate Modeling</em>, 2010, Prop. 13.3.2.</p><p>Note that within our hybrid model framework, the correlation <span>$\Gamma_{f}$</span> is part of the full risk factor correlation matrix <span>$\Gamma$</span>. Consequently, for our hybrid model interface, we use the specification</p><p class="math-container">\[\sigma_{t}^{\top}=H(t)H^{f}(t)^{-1}\sigma_{t}^{f}.\]</p><h3 id="Multi-factor-Gaussian-Model"><a class="docs-heading-anchor" href="#Multi-factor-Gaussian-Model">Multi-factor Gaussian Model</a><a id="Multi-factor-Gaussian-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Multi-factor-Gaussian-Model" title="Permalink"></a></h3><p>In order fully specify an interest rate model we need to define the <span>$d\times d$</span> volatility process matrix <span>$\left(\sigma_{t}\right)_{t}$</span>. By means of the benchmark forward rates <span>$f_{i}$</span> we already reduced this problem to the specification of the <span>$d$</span> individual benchmark rate volatility processes <span>$\left(\sigma_{i,t}\right)_{t}$</span>. In this section, we give a first full specification of the benchmark rate volatility processes.</p><p>In a Gaussian model we assume deterministic volatility processes <span>$\sigma_{i,t}=\sigma_{i}\left(t\right)$</span> for <span>$i=1,\ldots,d$</span>. In order to simplify analytics, er also assume that the volatility functions <span>$\sigma_{i}\left(t\right)$</span> are piece-wise constant. Then, also the model volatility <span>$\sigma_{t}=\sigma\left(t\right)$</span> is deterministic and piece-wise constant.</p><p>An important consequence of this modelling choice is that the auxiliary state process <span>$y_{t}$</span> also becomes deterministic and easily computable. Assume <span>$y\left(s\right)$</span> is known and <span>$\sigma\left(u\right)=\sigma$</span> is constant on the intervall <span>$\left(s,t\right)$</span>. Then</p><p class="math-container">\[y\left(s\right)=H\left(s,t\right)y\left(s\right)H\left(s,t\right)+\int_{s}^{t}H\left(u,t\right)\sigma^{\top}\sigma H\left(u,t\right)ds.\]</p><p>The integral becomes</p><p class="math-container">\[\begin{aligned}
\int_{s}^{t}H\left(u,t\right)\sigma^{\top}\sigma H\left(u,t\right)ds &amp; =\left[\int_{s}^{t}e^{-\chi_{i}\left(t-u\right)}\left[\sigma^{\top}\sigma\right]_{i,j}e^{-\chi_{j}\left(t-u\right)}du\right]_{i,j=1,\ldots,d}\\
 &amp; =\left[\left[\sigma^{\top}\sigma\right]_{i,j}\int_{s}^{t}e^{-\left(\chi_{i}+\chi_{j}\right)\left(t-u\right)}du\right]_{i,j=1,\ldots,d}\\
 &amp; =\left[\left[\sigma^{\top}\sigma\right]_{i,j}\left[\frac{1-e^{-\left(\chi_{i}+\chi_{j}\right)\left(t-u\right)}}{\chi_{i}+\chi_{j}}\right]\right]_{i,j=1,\ldots,d}.
\end{aligned}\]</p><p>With this formula we calculate and store <span>$\left(y\left(t_{k}\right)\right)_{k}$</span> on the grid <span>$\left(t_{1},t_{2},\ldots\right)$</span> of piece-wise constant volatility values <span>$\left(\sigma_{\left(k\right)}\right)_{k}$</span>. Then a value <span>$y\left(t\right)$</span> for some <span>$t_{k-1}\leq t&lt;t_{k}$</span> is calculated as</p><p class="math-container">\[y\left(t\right)=H\left(t_{k-1},t\right)y\left(t_{k-1}\right)H\left(t_{k-1},t\right)+\left[\left[\sigma_{\left(k\right)}^{\top}\sigma_{\left(k\right)}\right]_{i,j}\left[\frac{1-e^{-\left(\chi_{i}+\chi_{j}\right)\left(t-t_{k-1}\right)}}{\chi_{i}+\chi_{j}}\right]\right]_{i,j=1,\ldots,d}.\]</p><p><strong>Hybrid model interface.</strong></p><p>In our hybrid model framework we need to take into account that we simulate in a measure other than the natural risk neutral measure for a given rates model. In such a situation need to take into account quanto adjustments. Denote <span>$\left(W_{t}^{n}\right)_{t}$</span> a Brownian motion under a common hybrid mode risk neutral measure. Girsanov&#39;s theorem yields that there is a process <span>$\left(\alpha_{t}\right)_{t}$</span> and</p><p class="math-container">\[W_{t}^{n}=W_{t}+\int_{0}^{t}\alpha_{s}dt.\]</p><p>With this change of measure, we get</p><p class="math-container">\[x_{t}=H\left(s,t\right)\left[x_{s}+y_{s}G\left(s,t\right)+\int_{s}^{t}H\left(s,u\right)^{-1}\sigma_{u}^{\top}\left[\sigma_{u}G\left(u,t\right)du+\left[dW_{u}^{n}-\alpha_{u}du\right]\right]\right].\]</p><p class="math-container">\[\begin{aligned}
x_{t} &amp; =H\left(s,t\right)y\left(s\right)G\left(s,t\right)+\int_{s}^{t}H\left(u,t\right)\sigma\left(u\right)^{\top}\left[\sigma\left(u\right)G\left(u,t\right)-\alpha_{u}\right]du+\\
 &amp; \quad H\left(s,t\right)x_{s}+\\
 &amp; \quad\int_{s}^{t}H\left(u,t\right)\sigma\left(u\right)^{\top}dW_{u}^{n}.
\end{aligned}\]</p><p>Furthermore, we have for the integrated state variable</p><p class="math-container">\[\begin{aligned}
z_{t} &amp; =z_{s}+G\left(s,t\right)^{\top}x_{s}+\int_{s}^{t}G\left(u,t\right)^{\top}\left[y\left(u\right)\boldsymbol{1}du+\sigma\left(u\right)^{\top}\left[dW_{u}^{n}-\alpha_{u}du\right]\right]\\
 &amp; =z_{s}+G\left(s,t\right)^{\top}x_{s}+\int_{s}^{t}G\left(u,t\right)^{\top}\left[\left[y\left(u\right)\boldsymbol{1}-\sigma\left(u\right)^{\top}\alpha_{u}\right]du+\sigma\left(u\right)^{\top}dW_{u}^{n}\right].
\end{aligned}\]</p><p>As a result, we find that we can specify our hybrid model state variable <span>$X_{t}^{k}$</span> and identify the model component functions <span>$\Theta^{k}\left(\cdot\right)$</span>, <span>$H^{k}\left(\cdot\right)$</span> and <span>$\Sigma^{k}\left(\cdot\right)$</span> for a Gaussian model. We set</p><p class="math-container">\[X_{t}^{k}=\left[\begin{array}{c}
x_{t}\\
z_{t}
\end{array}\right]=\left[\begin{array}{c}
x_{t}^{1}\\
\vdots\\
x_{t}^{d}\\
z_{t}
\end{array}\right].\]</p><p>Then</p><p class="math-container">\[\begin{aligned}
\Theta^{k}\left(s,t\right) &amp; =\left[\begin{array}{c}
H\left(s,t\right)y\left(s\right)G\left(s,t\right)+\int_{s}^{t}H\left(u,t\right)\sigma\left(u\right)^{\top}\left[\sigma\left(u\right)G\left(u,t\right)-\alpha_{u}\right]du\\
\int_{s}^{t}G\left(u,t\right)^{\top}\left[y\left(u\right)\boldsymbol{1}-\sigma\left(u\right)^{\top}\alpha_{u}\right]du
\end{array}\right],\\
H^{k}\left(s,t\right) &amp; =\left[\begin{array}{cc}
H\left(s,t\right) &amp; 0\\
G\left(s,t\right)^{\top} &amp; 1
\end{array}\right],\\
\Sigma\left(u\right)^{\top} &amp; =\left[\begin{array}{c}
H\left(u,t\right)\sigma\left(u\right)^{\top}\\
G\left(u,t\right)^{\top}\sigma\left(u\right)^{\top}
\end{array}\right].
\end{aligned}\]</p><p>We note, that the drift function <span>$\Theta^{k}$</span> is only state-independent if the quanto drift <span>$\alpha_{t}$</span> is state-independent. This property is closely linked to the volatility assumptions of the foreign exchange model between rates model&#39;s currency and the hybrid model numeraire currency.</p><p><strong>Alternative drift formula.</strong></p><p class="math-container">\[x_{t}=H\left(s,t\right)\left[x_{s}+\int_{s}^{t}H\left(s,u\right)^{-1}\left[y_{u}\boldsymbol{1}du+\sigma_{u}^{\top}\left[dW_{u}^{n}-\alpha_{u}du\right]\right]\right].\]</p><p class="math-container">\[\begin{aligned}
x_{t} &amp; =\int_{s}^{t}H\left(u,t\right)\left[y\left(u\right)\boldsymbol{1}-\sigma\left(u\right)^{\top}\alpha_{u}\right]dt+\\
 &amp; \quad H\left(s,t\right)x_{s}+\\
 &amp; \quad\int_{s}^{t}H\left(u,t\right)\sigma\left(u\right)^{\top}dW_{u}^{n}
\end{aligned}\]</p><h2 id="Tradeable-Asset-Models"><a class="docs-heading-anchor" href="#Tradeable-Asset-Models">Tradeable Asset Models</a><a id="Tradeable-Asset-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Tradeable-Asset-Models" title="Permalink"></a></h2><p>In this subsection we specify our component models for tradeable assets. Such assets are typically foreign exchange rates, equities, equity indices and inflation indices. We use the notation of foreign exchange rates models with <em>domestic</em> and <em>foreign</em> currency. An adaption to equity and inflation models is then straight forward.</p><h3 id="Hybrid-FX-Modelling-Framework"><a class="docs-heading-anchor" href="#Hybrid-FX-Modelling-Framework">Hybrid FX Modelling Framework</a><a id="Hybrid-FX-Modelling-Framework-1"></a><a class="docs-heading-anchor-permalink" href="#Hybrid-FX-Modelling-Framework" title="Permalink"></a></h3><p>We consider the positive price process <span>$\left(S_{t}\right)_{t}$</span> of one unit of foreign currency measured by units of domestic currency. Moreover, denote <span>$\left(B_{t}^{d}\right)_{t}$</span> and <span>$\left(B_{t}^{f}\right)_{t}$</span> the bank account processes in domestic and foreign currency. The process <span>$\left(S_{t}B_{t}^{f}\right)_{t}$</span> represents the price process of the foreign currency bank account measured in units of domestic currency. This is a tradeable asset in domestic currency. The domestic currency risk-neutral measure uses the bank account <span>$\left(B_{t}^{d}\right)_{t}$</span> as numeraire. As a consequence, the process</p><p class="math-container">\[\left(\frac{S_{t}B_{t}^{f}}{B_{t}^{d}}\right)_{t}\]</p><p>must be a martingale.</p><p>The martingale property motivates the asset price process</p><p class="math-container">\[S_{t}=\frac{B_{t}^{d}}{B_{t}^{f}}e^{x_{t}}\]</p><p>for a normalised state variable process <span>$\left(x_{t}\right)_{t}$</span>. For the state variable we assume the dynamics</p><p class="math-container">\[x_{t}=-\frac{1}{2}\int_{0}^{t}\sigma_{s}^{2}ds+\int_{0}^{t}\sigma_{s}dW_{s}.\]</p><p>Here, <span>$\left(\sigma_{t}\right)_{t}$</span> is a scalar volatility process adapted to <span>${\cal F}_{t}$</span>, and <span>$\left(W_{t}\right)_{t}$</span> is a scalar Brownian motion in the domestic currency risk-neutral measure.</p><p>Note that above specification of the process <span>$\left(x_{t}\right)_{t}$</span> covers a wide range of models. The models are distinguished by the modelling of the volatility process <span>$\left(\sigma_{t}\right)_{t}$</span>. The representation <span>$S_{t}=\left(B_{t}^{d}/B_{t}^{f}\right)e^{x_{t}}$</span> allows for a clear decoupling of interest rate modelling and hybrid asset modelling. For the sake of clarity we can also write the dynamics of <span>$\left(S_{t}\right)_{t}$</span> explicitely as</p><p class="math-container">\[S_{t}=S_{s}+\int_{s}^{t}S_{u}\left(r_{u}^{d}-r_{u}^{f}\right)du+\int_{s}^{t}\sigma_{u}dW_{u}\]</p><p>with domestic and foreign short rates <span>$r_{u}^{d}$</span> and <span>$r_{u}^{f}$</span>.</p><p>There is an important consequence from the asset price representation <span>$S_{t}=\left(B_{t}^{d}/B_{t}^{f}\right)e^{x_{t}}$</span> . In order to reconstruct future asset prices <span>$S_{t}$</span> the asset model must <em>know</em> its corresponding domestic and foreign interest rate model. Moreover, the asset model also requires the integrated state variables <span>$z_{t}^{d}$</span> and <span>$z_{t}^{f}$</span> in order to allow for the domestic and foreign interest rate model to calculate <span>$B_{t}^{d}$</span> and <span>$B_{t}^{f}$</span>.</p><h3 id="Quanto-Adjustment"><a class="docs-heading-anchor" href="#Quanto-Adjustment">Quanto Adjustment</a><a id="Quanto-Adjustment-1"></a><a class="docs-heading-anchor-permalink" href="#Quanto-Adjustment" title="Permalink"></a></h3><p>So far, we implicitly assumed that interest rate models are formulated in the risk-neutral measure of their respective currency. Similarly, we also assumed that asset models are formulated in their respective domestic currency risk neutral measure.</p><p>In a hybrid modelling framework for various currencies we need to decide on a common numeraire currency, the corresponding numeraire price process and the common martingale measure. Such a common martingale measure in general does not coincide with the risk-neutral measures that are typically used to formulate foreign currency component models. Consequently, we need to incorporate a change of measure for such foreign currency component models.</p><p>In this section, we formulate the change of measure from a given risk neutral measure to a common numeraire currency risk neutral measure. The change of measure is formulated in a rather general way in order to apply it later on for various component models. We consider a domestic currency with some asset price process <span>$X_{t}^{d}$</span>. For practical purposes, such an asset is typically</p><ul><li><p>a domestic zero coupon bond with price process   <span>$\left(P^{d}\left(t,T\right)\right)_{t}$</span> or</p></li><li><p>foreign currency bank account measured in units of domestic currency   with price process <span>$\left(S_{t}^{f-d}B_{t}^{f}\right)_{t}$</span>.</p></li></ul><p>The corresponding domestic currency discounted asset process is denoted <span>$\left(\tilde{X}_{t}^{d}\right)_{t}$</span> with</p><p class="math-container">\[\tilde{X}_{t}^{d}=\frac{X_{t}^{d}}{B_{t}^{d}}.\]</p><p>Without loss of generality, we assume that the discounted asset price process follows the dynamics</p><p class="math-container">\[\frac{d\tilde{X}_{t}^{d}}{\tilde{X}_{t}^{d}}=\left[\sigma_{t}^{X^{d}}\right]^{\top}dW_{t}^{d}\]</p><p>where <span>$\left(\sigma_{t}^{X^{d}}\right)_{t}$</span> is an adapted process and <span>$\left(W_{t}^{d}\right)_{t}$</span> is a <span>$n^{d}$</span>-dimensional Brownian motion in domestic currency risk neutral measure <span>$\mathbb{Q}^{d}$</span>.</p><p>In addition to the domestic (and foreign) currency we consider a numeraire currency with bank account prices <span>$B_{t}^{n}$</span>. The price of one unit domestic currency measured by units of numeraire currency is denoted as <span>$S_{t}^{d-n}$</span>. The price of our domestic currency asset measured in units of numeraire currency is <span>$S_{t}^{d-n}X_{t}^{d}$</span>. Under the numeraire currency risk-neutral measure <span>$\mathbb{Q}^{n}$</span> with numeraire price process <span>$\left(B_{t}^{n}\right)_{t}$</span> we can also formulate the discounted price process <span>$\left(M_{t}\right)_{t}$</span> with <span>$M_{t}=\frac{S_{t}^{d-n}P^{d}\left(t,T\right)}{B_{t}^{n}}.$</span> No-arbitrage arguments require that <span>$\left(M_{t}\right)_{t}$</span> is a <span>$\mathbb{Q}^{n}$</span>-martingale.</p><p>Using our hybrid FX modelling framework we can write <span>$M_{t}$</span> as</p><p class="math-container">\[M_{t}=\frac{B_{t}^{n}}{B_{t}^{d}}e^{x_{t}^{d-n}}\frac{X_{t}^{d}}{B_{t}^{n}}=\frac{X_{t}^{d}}{B_{t}^{d}}e^{x_{t}^{d-n}}=\tilde{X}_{t}^{d}e^{x_{t}^{d-n}}.\]</p><p>with domestic numeraire FX model state variable process <span>$\left(x_{t}^{d-n}\right)_{t}$</span>. In order to further simplify notation, we set <span>$Y_{t}^{d-n}=e^{x_{t}^{d-n}}$</span> and note that</p><p class="math-container">\[\begin{aligned}
Y_{t}^{d-n} &amp; =Y_{0}^{d-n}+\int_{0}^{t}Y_{s}^{d-n}dx_{s}^{d-n}+\frac{1}{2}\int_{0}^{t}Y_{s}^{d-n}d\left\langle x_{s}^{d-n},x_{s}^{d-n}\right\rangle \\
 &amp; =Y_{0}^{d-n}+\int_{0}^{t}Y_{s}^{d-n}\sigma_{s}^{d-n}dW_{s}^{d-n}.
\end{aligned}\]</p><p>In this representation, <span>$\left(\sigma_{t}^{d-n}\right)_{t}$</span> is the FX volatility process of <span>$\left(S_{t}^{d-n}\right)_{t}$</span> and <span>$\left(W_{t}^{d-n}\right)_{t}$</span> is a Brownian motion in numeraire currency risk neutral measure. Above calculation also demonstrates that <span>$\left(Y_{t}^{d-n}\right)_{t}$</span> is a <span>$\mathbb{Q}^{n}$</span>-martingale driven by an Ito integral.</p><p>Now, Ito product rule yields for the process <span>$\left(M_{t}\right)_{t}$</span> that</p><p class="math-container">\[M_{t}=M_{0}+\int_{0}^{t}\tilde{X}_{s}^{d}dY_{s}^{d-n}+\int_{0}^{t}Y_{s}^{d-n}d\tilde{X}_{s}^{d}+\int_{0}^{t}d\left\langle \tilde{X}_{s}^{d},Y_{s}^{d-n}\right\rangle .\]</p><p>The first Ito integral is</p><p class="math-container">\[I_{1}=\int_{0}^{t}\tilde{X}_{s}^{d}dY_{s}^{d-n}=\int_{0}^{t}M_{s}\sigma_{s}^{d-n}dW_{s}^{d-n}.\]</p><p>This term is a <span>$\mathbb{Q}^{n}$</span>-martingale. For the second integral we get</p><p class="math-container">\[I_{2}=\int_{0}^{t}Y_{s}^{d-n}d\tilde{X}_{s}^{d}=\int_{0}^{t}M_{s}\left[\sigma_{s}^{X^{d}}\right]^{\top}dW_{s}^{d}.\]</p><p>This term is a <span>$\mathbb{Q}^{d}$</span>-martingale because by construction <span>$\left(W_{t}^{d}\right)_{t}$</span> is a Brownian motion in the domestic currency risk neutral measure. for the third integral we get</p><p class="math-container">\[I_{3}=\int_{0}^{t}d\left\langle \tilde{X}_{s}^{d},Y_{s}^{d-n}\right\rangle =\int_{0}^{t}\left\langle d\tilde{X}_{s}^{d},dY_{s}^{d-n}\right\rangle =\int_{0}^{t}M_{s}\left\langle \left[\sigma_{s}^{X^{d}}\right]^{\top}dW_{s}^{d},\sigma_{s}^{d-n}dW_{s}^{d-n}\right\rangle .\]</p><p>Girsanov&#39;s theorem yields that there is an adapted process <span>$\left(\alpha_{t}\right)_{t}$</span> such that</p><p class="math-container">\[W_{t}^{d,n}=W_{t}^{d}+\int_{0}^{t}\alpha_{s}ds\]</p><p>is a Brownian motion under <span>$\mathbb{Q}^{n}$</span>. This yields</p><p class="math-container">\[I_{2}=\int_{0}^{t}M_{s}\left[\sigma_{t}^{X^{d}}\right]^{\top}\left(dW_{s}^{d,n}-\alpha_{s}ds\right).\]</p><p>For the third integral, we can now use linearity of covariance process and the property, that the quadratic variation of <span>$\int_{0}^{t}\alpha_{s}ds$</span> vanishes. This gives</p><p class="math-container">\[\begin{aligned}
I_{3} &amp; =\int_{0}^{t}M_{s}\left\langle \left[\sigma_{s}^{X^{d}}\right]^{\top}\left(dW_{s}^{d,n}-\alpha_{s}ds\right),\sigma_{s}^{d-n}dW_{s}^{d-n}\right\rangle \\
 &amp; =\int_{0}^{t}M_{s}\left\langle \left[\sigma_{s}^{X^{d}}\right]^{\top}dW_{s}^{d,n},\sigma_{s}^{d-n}dW_{s}^{d-n}\right\rangle .
\end{aligned}\]</p><p>The Brownian motion increments are correlated such that</p><p class="math-container">\[\left\langle dW_{s}^{d,n},dW_{s}^{d-n}\right\rangle =\Gamma^{X^{d},S^{d-n}}dt\]</p><p>with instantaneous correlation matrix <span>$\Gamma^{X^{d},S^{d-n}}$</span> of shape <span>$\left(n^{d},1\right)$</span>. This leads to the representation</p><p class="math-container">\[I_{3}=\int_{0}^{t}M_{s}\left[\sigma_{s}^{X^{d}}\right]^{\top}\Gamma^{X^{d},S^{d-n}}\sigma_{s}^{d-n}ds.\]</p><p>Recall that <span>$\left(M_{t}\right)_{t}$</span> is a <span>$\mathbb{Q}^{n}$</span>-martingale. This requires that</p><p class="math-container">\[I_{2}+I_{3}=\int_{0}^{t}M_{s}\left[\sigma_{t}^{X^{d}}\right]^{\top}\left(dW_{s}^{d,n}+\left[\Gamma^{X^{d},S^{d-n}}\sigma_{s}^{d-n}-\alpha_{s}\right]ds\right)\]</p><p>is a <span>$\mathbb{Q}^{n}$</span>-martingale. This leads to the condition</p><p class="math-container">\[\alpha_{t}=\Gamma^{X^{d},S^{d-n}}\sigma_{t}^{d-n}\]</p><p>and the change of measure formula</p><p class="math-container">\[W_{t}^{d,n}=W_{t}^{d}+\int_{0}^{t}\Gamma^{X^{d},S^{d-n}}\sigma_{s}^{d-n}ds.\]</p><p><strong>Quanto adjustment for rates models.</strong></p><p>For Gaussian rates models in a domestic currency we have</p><p class="math-container">\[\Theta^{k}\left(s,t\right)=\left[\begin{array}{c}
H\left(s,t\right)y\left(s\right)G\left(s,t\right)+\int_{s}^{t}H\left(u,t\right)\sigma^{d}\left(u\right)^{\top}\left[\sigma^{d}\left(u\right)G\left(u,t\right)-\alpha_{u}\right]du\\
\int_{s}^{t}G\left(u,t\right)^{\top}\left[y\left(u\right)\boldsymbol{1}-\sigma^{d}\left(u\right)^{\top}\alpha_{u}\right]du
\end{array}\right].\]</p><p>Assets prices are zero coupon bonds, <span>$X_{t}^{d}=P^{d}\left(t,T\right)$</span> driven by the state variable <span>$x_{t}^{d}$</span>. Consequently, the quanto adjustment drift becomes</p><p class="math-container">\[\alpha_{t}=\Gamma^{x^{d},S^{d-n}}\sigma_{t}^{d-n}.\]</p><p>Here, <span>$\Gamma^{x^{d},S^{d-n}}$</span> summarises the instantaneous correlations of the interest rate risk factors and the FX risk factor. Assuming FX volatility is deterministic with <span>$\sigma_{t}^{d-n}=\sigma^{d-n}\left(t\right)$</span>, we get</p><p class="math-container">\[\Theta^{k}\left(s,t\right)=\left[\begin{array}{c}
H\left(s,t\right)y\left(s\right)G\left(s,t\right)+\int_{s}^{t}H\left(u,t\right)\sigma^{d}\left(u\right)^{\top}\left[\sigma^{d}\left(u\right)G\left(u,t\right)-\Gamma^{x^{d},S^{d-n}}\sigma_{t}^{d-n}\right]du\\
\int_{s}^{t}G\left(u,t\right)^{\top}\left[y\left(u\right)\boldsymbol{1}-\sigma^{d}\left(u\right)^{\top}\Gamma^{x^{d},S^{d-n}}\sigma_{t}^{d-n}\right]du
\end{array}\right].\]</p><h3 id="Lognormal-Model"><a class="docs-heading-anchor" href="#Lognormal-Model">Lognormal Model</a><a id="Lognormal-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Lognormal-Model" title="Permalink"></a></h3><p>We construct a basic asset model by assuming that the volatility process <span>$\left(\sigma_{t}^{f-d}\right)_{t}$</span> is deterministic, i.e. <span>$\sigma_{t}^{f-d}=\sigma^{f-d}\left(t\right)$</span>. Then</p><p class="math-container">\[x_{t}^{f-d}=x_{s}^{f-d}-\frac{1}{2}\int_{s}^{t}\sigma^{f-d}\left(u\right)^{2}du+\int_{s}^{t}\sigma^{f-d}\left(u\right)dW_{u}^{d}.\]</p><p>If the domestic currency differs from the numeraire currency then we need to incorporate quanto adjustment with</p><p class="math-container">\[W_{t}^{d,n}=W_{t}^{d}+\int_{0}^{t}\Gamma^{S^{f-d},S^{d-n}}\sigma_{s}^{d-n}ds.\]</p><p>This yields</p><p class="math-container">\[\begin{aligned}
x_{t}^{f-d} &amp; =x_{s}^{f-d}-\frac{1}{2}\int_{s}^{t}\sigma^{f-d}\left(u\right)^{2}du+\int_{s}^{t}\sigma^{f-d}\left(u\right)\left[dW_{u}^{d,n}-\Gamma^{S^{f-d},S^{d-n}}\sigma_{u}^{d-n}du\right]\\
 &amp; =x_{s}^{f-d}-\frac{1}{2}\int_{s}^{t}\sigma^{f-d}\left(u\right)\left[\sigma^{f-d}\left(u\right)+2\Gamma^{S^{f-d},S^{d-n}}\sigma_{u}^{d-n}\right]du+\int_{s}^{t}\sigma^{f-d}\left(u\right)dW_{u}^{d,n}.
\end{aligned}\]</p><p>In this model setting the state variable process <span>$\left(x_{t}^{f-d}\right)_{t}$</span> has normal terminal distributions. Consequently, <span>$e^{x_{t}}$</span> is lognormal. If interest rates are modelled by (multi-factor) Gaussian models then <span>$B_{t}^{d}$</span> and <span>$B_{t}^{f}$</span> are also lognormal. As a result, we find that the asset price <span>$S_{t}$</span> is also lognormal.</p><p>In the lognormal model, our generic hybrid model state variable <span>$X_{t}^{k}$</span> and component functions <span>$\Theta^{k}\left(\cdot\right)$</span>, <span>$H^{k}\left(\cdot\right)$</span> and <span>$\Sigma^{k}\left(\cdot\right)$</span> are easily identified. We set</p><p class="math-container">\[\begin{aligned}
X_{t}^{k} &amp; =\left[x_{t}\right],\\
\Theta^{k}\left(s,t\right) &amp; =\left[-\frac{1}{2}\int_{s}^{t}\sigma^{f-d}\left(u\right)\left[\sigma^{f-d}\left(u\right)+2\Gamma^{S^{f-d},S^{d-n}}\sigma_{u}^{d-n}\right]du\right],\\
H^{k}\left(s,t\right) &amp; =\left[1\right],\\
\Sigma^{k}\left(u\right)^{\top} &amp; =\left[\sigma^{f-d}\left(u\right)\right].
\end{aligned}\]</p><h2 id="Future-Index/Price-Models"><a class="docs-heading-anchor" href="#Future-Index/Price-Models">Future Index/Price Models</a><a id="Future-Index/Price-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Future-Index/Price-Models" title="Permalink"></a></h2><p>In this section we specify models for Future index curves or Future price curves. Such models are typical for commodity derivatives.</p><h3 id="Markov-Model-Specification"><a class="docs-heading-anchor" href="#Markov-Model-Specification">Markov Model Specification</a><a id="Markov-Model-Specification-1"></a><a class="docs-heading-anchor-permalink" href="#Markov-Model-Specification" title="Permalink"></a></h3><p>The model is specified following  <a href="../overview/#label_literature_and_references">Andersen 2008</a>, eq. (10) - (12). We keep notation as close as possible to the HJM model specification used for interest rates.</p><p>We denote</p><p class="math-container">\[F\left(t,T\right)\]</p><p>a Future index or future price curve. The Future price is denominated in units of domestic currency. A key proposition is that for <span>$t\leq T$</span> the future price <span>$\left(F\left(t,T\right)\right)_{t}$</span> is a martingale in the domestic currency risk-neutral measure. The martingale property and the theory of separable HJM models motivate the specification</p><p class="math-container">\[F\left(t,T\right) = 
F\left(0,T\right)\exp
  \left\{ 
    h\left(t,T\right)^{\top}
    \left[
        x_{t}+\frac{1}{2}y_{t}\left(I-H\left(t,T\right)\right)\boldsymbol{1}
    \right]
\right\}\]</p><p>with <span>$d$</span>-dimensional state variable process <span>$\left(x_{t}\right)_{t}$</span> and <span>$d\times d$</span>-dimensional auxiliary (variance) variable process <span>$\left(y_{t}\right)_{t}$</span>. State and auxiliary variable follow the dynamics</p><p class="math-container">\[\begin{aligned}
  x_{t} &amp;=
  H\left(s,t\right)
  \left[
    x_{s}+\int_{s}^{t}H\left(s,u\right)^{-1}
    \left[
        \frac{1}{2}
        \left(
            y_{u}\chi\left(u\right)-\sigma_{u}^{\top}\sigma_{u}
        \right)
        \boldsymbol{1}du+\sigma_{u}^{\top}dW_{u}^{d}
    \right]
  \right],\\
  y_{t} &amp;=
  H\left(s,t\right)y_{s}H\left(s,t\right)+
  \int_{s}^{t}H\left(u,t\right)\sigma_{u}^{\top}\sigma_{u}H\left(u,t\right)du.
  \end{aligned}\]</p><p><strong>Quanto-adjustment.</strong></p><p>If the domestic currency differs from the numeraire currency then we need to incorporate the change of measure</p><p class="math-container">\[\begin{aligned}
  W_{t}^{d,n}
  &amp;= W_{t}^{d}+\int_{0}^{t}\alpha_{s}ds\\
  &amp;= W_{t}^{d}+\int_{0}^{t}\Gamma^{X^{d},S^{d-n}}\sigma_{s}^{d-n}ds.
\end{aligned}\]</p><p>This yields the state variable representation with Quanto adjustment as</p><p class="math-container">\[x_{t} =
H\left(s,t\right)
\left[
  x_{s} + 
  \int_{s}^{t}H\left(s,u\right)^{-1}
  \left[
    \frac{1}{2}\left(y_{u}\chi\left(u\right)\boldsymbol{1} -
    \sigma_{u}^{\top}\left[\sigma_{u}\boldsymbol{1}-2\alpha_{u}\right]\right)du +
    \sigma_{u}^{\top}dW_{u}^{d,n}
  \right]
\right].\]</p><h3 id="Multi-factor-Gaussian-Model-2"><a class="docs-heading-anchor" href="#Multi-factor-Gaussian-Model-2">Multi-factor Gaussian Model</a><a class="docs-heading-anchor-permalink" href="#Multi-factor-Gaussian-Model-2" title="Permalink"></a></h3><p>A critical aspect is the specification of the volatility process <span>$\left(\sigma_{t}\right)_{t}$</span>. For the Gaussian Future index model we re-use the methodology from the interest rate model. That is, we assume constant mean reversion parameters <span>$\chi_{1},\ldots,\chi_{d}$</span> and benchmark times <span>$\delta_{1},\ldots,\delta_{d}$</span>. Moreover, denote <span>$\Gamma^{F}=\left[\Gamma_{ij}^{F}\right]$</span> the instantaneous correlations between Future prices <span>$F\left(t,t+\delta_{i}\right)$</span> and <span>$F\left(t,t+\delta_{j}\right)$</span>.</p><p>Then we set</p><p class="math-container">\[\sigma_{t}^{\top}=H(t)H^{F}(t)^{-1}\sigma_{t}^{F}\left[D^{F}(t)\right]^{\top}\]</p><p>with</p><p class="math-container">\[\begin{aligned}
H(t)H^{F}(t)^{-1} &amp; =\left(\begin{array}{ccc}
e^{-\chi_{1}\delta_{1}} &amp; \ldots &amp; e^{-\chi_{d}\delta_{1}}\\
\vdots &amp;  &amp; \vdots\\
e^{-\chi_{1}\delta_{d}} &amp; \ldots &amp; e^{-\chi_{d}\delta_{d}}
\end{array}\right)^{-1},\\
\left[D^{F}(t)\right]^{\top}D^{F}(t) &amp; =\Gamma^{F}.
\end{aligned}\]</p><p>This methodology reduces the modelling to the specification of a diagonal matrix of benchmark price volatilities</p><p class="math-container">\[\sigma_{t}^{F}=\left(\begin{array}{ccc}
\sigma_{t}^{F_{1}}\\
 &amp; \ddots\\
 &amp;  &amp; \sigma_{t}^{F_{d}}
\end{array}\right).\]</p><p>For the Gaussian Future index model, we further assume piece-wise constant volatility functions <span>$\sigma_{t}^{F_{i}}=\sigma_{i}\left(t\right)$</span>. Then, also the model volatility <span>$\sigma_{t}=\sigma\left(t\right)$</span> is deterministic and piece-wise constant. With this specification the auxilliary variable process <span>$\left(y_{t}\right)_{t}$</span> is deterministic as well. And we can re-use the machinery from interest rate models to calculate <span>$y_{t}=y\left(t\right)$</span>.</p><p><strong>Hybrid model interface.</strong></p><p>We specify the hybrid model state variable <span>$X_{t}^{k}$</span> and identify the model component functions <span>$\Theta^{k}\left(\cdot\right)$</span>, <span>$H^{k}\left(\cdot\right)$</span> and <span>$\Sigma^{k}\left(\cdot\right)$</span> for a Gaussian Future price model.</p><p>We set</p><p class="math-container">\[X_{t}^{k}=\left[\begin{array}{c}
x_{t}^{1}\\
\vdots\\
x_{t}^{d}
\end{array}\right].\]</p><p>Then</p><p class="math-container">\[\begin{aligned}
\Theta^{k}\left(s,t\right)
&amp;= \frac{1}{2}\int_{s}^{t}H\left(u,t\right)
   \left[
     \left(
        y\left(u\right)\chi\boldsymbol{1}-
        \left[
            \sigma\left(u\right)^{\top}\sigma\left(u\right)\boldsymbol{1} - 
            2\sigma\left(u\right)^{\top}\alpha\left(u\right)
        \right]
     \right) du
    \right],\\
H^{k}\left(s,t\right) &amp;= H\left(s,t\right),\\
\Sigma^{k}\left(u\right)^{\top}
&amp;= H\left(u,t\right)\sigma\left(u\right)^{\top}.
\end{aligned}\]</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../overview/">« Overview</a><a class="docs-footer-nextpage" href="../../termstructures/termstructures/">Term Structures Functions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Friday 12 April 2024 12:40">Friday 12 April 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
